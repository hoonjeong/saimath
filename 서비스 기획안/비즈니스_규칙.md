# 사이수학 입학테스트 - 비즈니스 규칙

## 1. 시험지 관리 규칙

### 1.1 시험지 생성
- **규칙**: 하나의 학년-학기 조합에는 하나의 시험지만 존재
  - 예: "초3-1학기" 시험지는 1개만
  - 조건: 관리자가 동일 학년-학기 시험지 생성 시도
  - 결과: "이미 존재합니다. 수정하시겠습니까?" 확인 요청

### 1.2 문제 개수
- **규칙**: 시험지는 정확히 25문제로 구성
  - 조건: 저장 시 문제 개수 확인
  - 결과: 25개 미만이면 저장 불가, "모든 문제를 입력해주세요" 알림

### 1.3 문제 구성 요소
- **규칙**: 각 문제는 다음을 필수로 포함
  - 선지 4개 (필수)
  - 정답 1개 선택 (필수)
  - 문제 이미지 (선택)
  - 조건: 저장 또는 다음 문제 이동 시
  - 결과: 미입력 항목 있으면 이동 불가, 에러 메시지 표시

### 1.4 이미지 제약
- **규칙**: 문제 이미지 업로드 제한
  - 형식: JPG, PNG만 허용
  - 용량: 최대 5MB
  - 조건: 파일 업로드 시도 시
  - 결과: 조건 위반 시 업로드 차단, 에러 메시지

---

## 2. 학생 응시 규칙

### 2.1 정보 입력 필수
- **규칙**: 모든 필수 정보를 입력해야 테스트 시작 가능
  - 필수 항목: 이름, 전화번호, 학년, 학기
  - 조건: '시작하기' 버튼 클릭 시
  - 결과: 미입력 항목 있으면 해당 항목에 에러 표시

### 2.2 전화번호 형식
- **규칙**: 전화번호는 010-0000-0000 형식
  - 조건: 전화번호 입력 시
  - 결과: 자동으로 하이픈 삽입 (입력 중)
  - 예외: 형식 맞지 않으면 "올바른 형식이 아닙니다" 에러

### 2.3 시험지 존재 확인
- **규칙**: 선택한 학년-학기의 시험지가 존재해야 함
  - 조건: 정보 입력 완료 후 시험 로딩 시
  - 결과: 
    - 있음 → 테스트 시작
    - 없음 → "시험지가 없습니다" 알림, 정보 입력 화면으로 복귀

### 2.4 선지 선택 필수
- **규칙**: 선지를 선택해야 다음 문제로 진행 가능
  - 조건: '다음' 버튼 클릭 시
  - 결과: 
    - 미선택 시 버튼 비활성화로 원천 차단
    - 선택 시 버튼 활성화

### 2.5 순차 진행
- **규칙**: 문제는 1번부터 25번까지 순서대로 진행
  - 조건: 문제 풀이 중
  - 결과: 
    - 이전 문제로 돌아갈 수 없음
    - 문제 건너뛰기 불가
    - 한 번 제출하면 수정 불가

### 2.6 중복 응시 허용
- **규칙**: 동일 학생이 같은 학년-학기 시험을 여러 번 응시 가능
  - 조건: 이전에 응시 이력이 있는 학생이 재응시
  - 결과: 
    - 응시 제한 없음
    - 각 응시는 별도 기록으로 저장
    - 응시 일시로 구분

---

## 3. 채점 규칙

### 3.1 자동 채점
- **규칙**: 25번 문제 제출 즉시 자동 채점
  - 조건: 마지막 문제 제출 시
  - 결과: 
    - 각 문제의 학생 답안과 정답 비교
    - 일치 → 정답 (4점)
    - 불일치 → 오답 (0점)

### 3.2 배점
- **규칙**: 각 문제당 4점, 총 100점 만점
  - 계산식: `총점 = 정답 개수 × 4점`
  - 예시:
    - 25개 정답 → 100점
    - 21개 정답 → 84점
    - 0개 정답 → 0점

### 3.3 부분 점수 없음
- **규칙**: 정답만 점수, 오답은 0점
  - 조건: 채점 시
  - 결과: 정답/오답 이분법, 부분 점수 없음

---

## 4. 데이터 저장 규칙

### 4.1 시험지 저장
- **규칙**: 시험지는 로컬 DB에 저장
  - 저장 항목:
    - 학년 (1~6)
    - 학기 (1 또는 2)
    - 25개 문제 (이미지, 선지 4개, 정답)
    - 생성 일시
  - 조건: 관리자가 '저장' 버튼 클릭
  - 결과: DB에 영구 저장, 저장 완료 메시지

### 4.2 응시 결과 저장
- **규칙**: 학생의 응시 결과는 채점 완료 즉시 저장
  - 저장 항목:
    - 학생 정보 (이름, 전화번호)
    - 응시 학년/학기
    - 응시 일시 (년월일 시분초)
    - 25개 문제별 답안 (선택한 번호)
    - 총점
    - 정답 개수
  - 조건: 채점 완료 시
  - 결과: DB에 영구 저장

### 4.3 임시 저장
- **규칙**: 관리자가 시험지 작성 중 임시 저장 가능
  - 조건: '임시 저장' 버튼 클릭 또는 페이지 이탈 시
  - 결과:
    - 현재까지 입력한 문제 DB 저장
    - 완료되지 않은 시험지는 '미완성' 상태로 표시
    - 재접속 시 이어서 작성 가능

---

## 5. 결과 조회 규칙

### 5.1 조회 권한
- **규칙**: 관리자만 결과 조회 가능
  - 조건: 결과 페이지 접근 시
  - 결과:
    - 관리자 로그인 상태 → 접근 허용
    - 미로그인 상태 → 로그인 페이지로 리다이렉트

### 5.2 학생 식별
- **규칙**: 학생은 이름과 전화번호 조합으로 식별
  - 조건: 결과 조회 시
  - 결과:
    - 동명이인 구분: 전화번호로 구분
    - 동일 학생의 여러 응시: 응시 일시로 구분

### 5.3 결과 정렬
- **규칙**: 기본 정렬은 최근 응시일 내림차순
  - 조건: 결과 목록 표시 시
  - 결과:
    - 가장 최근 응시한 학생이 상단
    - 컬럼 클릭으로 다른 기준 정렬 가능 (이름, 점수 등)

### 5.4 필터링
- **규칙**: 학년, 학기, 기간별 필터링 가능
  - 조건: 필터 선택 시
  - 결과:
    - 조건에 맞는 데이터만 표시
    - 여러 필터 동시 적용 가능
    - 필터 초기화 기능 제공

---

## 6. 예외 상황 처리 규칙

### 6.1 네트워크 오류
- **규칙**: 데이터 저장 실패 시 재시도 안내
  - 조건: 서버 통신 실패
  - 결과:
    - "저장에 실패했습니다. 다시 시도해주세요" 알림
    - [재시도] 버튼 제공
    - 3회 실패 시 "관리자에게 문의하세요" 안내

### 6.2 브라우저 이탈
- **규칙**: 테스트 중 이탈 시 경고
  - 조건: 
    - 학생이 문제 풀이 중 브라우저 뒤로가기/닫기 시도
    - 관리자가 시험지 작성 중 페이지 이탈 시도
  - 결과:
    - "작업 중인 내용이 있습니다. 나가시겠습니까?" 확인 팝업
    - 확인 → 나가기 (데이터 손실)
    - 취소 → 현재 화면 유지

### 6.3 세션 만료
- **규칙**: 관리자 세션은 2시간 유지
  - 조건: 2시간 동안 활동 없음
  - 결과:
    - 자동 로그아웃
    - 다음 액션 시 "세션이 만료되었습니다" 알림
    - 로그인 페이지로 리다이렉트

### 6.4 데이터 없음
- **규칙**: 조회 결과가 없을 때 안내 표시
  - 조건: 검색, 필터링 결과 0건
  - 결과: "결과가 없습니다" 빈 상태 화면 표시

---

## 7. 보안 및 데이터 보호 규칙

### 7.1 개인정보 보호
- **규칙**: 학생의 개인정보는 암호화하여 저장
  - 대상: 이름, 전화번호
  - 조건: DB 저장 시
  - 결과: 암호화된 형태로 저장, 조회 시 복호화

### 7.2 관리자 인증
- **규칙**: 관리자 기능은 로그인 필수
  - 조건: 관리자 페이지 접근 시
  - 결과:
    - 로그인 상태 → 접근 허용
    - 미로그인 → 로그인 화면 표시

### 7.3 데이터 백업
- **규칙**: 모든 데이터는 일 1회 자동 백업
  - 대상: 시험지 데이터, 응시 결과 데이터
  - 조건: 매일 자정
  - 결과: 백업 파일 생성, 최근 7일치 보관

---

## 8. 성능 및 용량 규칙

### 8.1 응시 제한
- **규칙**: 동시 응시 학생 수 제한 없음
  - 조건: 여러 학생이 동시 접속
  - 결과: 제한 없이 모두 응시 가능

### 8.2 이미지 최적화
- **규칙**: 업로드된 이미지는 자동 최적화
  - 조건: 이미지 저장 시
  - 결과:
    - 긴 변 기준 1200px로 리사이징
    - 화질 80%로 압축
    - 용량 절감 및 로딩 속도 개선

### 8.3 페이지네이션
- **규칙**: 목록은 20개 단위로 페이징
  - 대상: 학생 목록, 응시 이력 목록
  - 조건: 목록 표시 시
  - 결과: 한 페이지에 20개씩 표시, 페이지 번호로 이동

---

## 9. 사용자 경험 규칙

### 9.1 피드백 제공
- **규칙**: 모든 액션에 즉각적인 피드백 제공
  - 예시:
    - 버튼 클릭 → 로딩 표시
    - 저장 완료 → 성공 토스트 메시지
    - 오류 발생 → 에러 메시지 + 해결 방법
  - 조건: 사용자 액션 발생 시
  - 결과: 0.5초 이내 피드백 표시

### 9.2 진행 상태 표시
- **규칙**: 긴 작업은 진행률 표시
  - 대상:
    - 학생: 문제 풀이 진행 (1/25, 2/25...)
    - 관리자: 시험지 작성 진행 (1/25, 2/25...)
  - 조건: 작업 진행 중
  - 결과: 프로그레스 바 또는 숫자로 표시

### 9.3 에러 메시지 명확성
- **규칙**: 에러 메시지는 문제와 해결 방법 포함
  - 형식: "[문제] + [해결 방법]"
  - 예시:
    - "이름을 입력해주세요"
    - "JPG 또는 PNG 파일만 업로드 가능합니다"
    - "시험지가 없습니다. 관리자에게 문의하세요"
  - 조건: 에러 발생 시
  - 결과: 사용자가 스스로 해결할 수 있도록 안내

---

## 10. 메시지 및 알림 규칙

### 10.1 점수별 메시지
- **규칙**: 채점 결과에 따라 다른 격려 메시지
  - 90점 이상: "🎉 훌륭합니다! 매우 잘했어요!"
  - 70~89점: "👍 잘했습니다! 좋은 결과예요!"
  - 70점 미만: "💪 다음에 다시 도전해보세요!"
  - 조건: 결과 화면 표시 시
  - 결과: 학생에게 긍정적 피드백 제공

### 10.2 확인 팝업
- **규칙**: 중요한 액션은 확인 팝업으로 재확인
  - 대상:
    - 25번 문제 제출 시
    - 시험지 저장 시
    - 페이지 이탈 시
  - 형식: "~하시겠습니까?" + [취소] [확인]
  - 조건: 해당 액션 시도 시
  - 결과: 사용자의 실수 방지

### 10.3 성공 알림
- **규칙**: 성공적인 작업은 토스트로 알림
  - 예시:
    - "저장되었습니다"
    - "제출되었습니다"
  - 조건: 작업 완료 시
  - 결과: 초록색 토스트, 3초 후 자동 사라짐
